Grammar:		DataElement 5.0
Namespace:	usdrugformulary
 Uses:  		shr.core

CodeSystem:  	RXN = http://www.nlm.nih.gov/research/umls/rxnorm


EntryElement:	CoveragePlan
// Based on:		List
Description:  "A health plan which contains a list of formulary drugs covered under that plan."
1..1      PlanIDType
1..1      PlanID
0..1      MarketingURL
0..1      MarketingName
0..1      FormularyURL
1..1      CoveragePlanStatus
1..1      CoveragePlanMode
0..1      EmailPlanContact
1..*      Network
1..*      DrugTierDefinition
0..*      FormularyDrugEntry
0..1      LastUpdatedOn

  Element: PlanIDType
  Description: "as per QHP"
  Value: string

  Element: PlanID
  Description: "as per QHP"
  Value: string

  Element: MarketingName
  Description: "as per QHP."
  Value: string

  Element: MarketingURL
  Description: "as per QHP"
  Value: string 

  Element: FormularyURL
  Description: "as per QHP"
  Value: string

  Element: EmailPlanContact
  Description: "as per QHP"
  Value: string 

  Element: Network
  Description: "as per QHP."
  Value: string

  Element: CoveragePlanMode
  Description: "required by List"
  Value: code

  Element: CoveragePlanStatus
  Description: "Current Status of the Plan."
  Value: code

  Element: FormularySource
  Description: "Author of the formulary."
  Value: string

  Element: FormularyStatus
  Description: "Current Status of the Formulary."
  Value: code

  Element: LastUpdatedOn
  Description:  "The date that the health plan was last updated."
  Value: dateTime

  Element: FormularyDrugEntry
  Description:  "A reference to a drug product which is included in the coverage plan."
  Value:  ref(FormularyDrug) or ref(FormularyDrugOption2)

  Element: DrugTierDefinition
  Description: "A description of the drug tiers used by the formulary and how those tiers implement copay and coinsurance amounts. Drug tiers do not have any inherent meaning that is consistent across all formularies. Rather, each tier is defined using this element."
  1..1  DrugTierID
  1..1  MailOrder
  0..*  CostSharing

 
    Element: DrugTierID
    Description: "A code that describes the coverage status of a drug in a health plan (e.g., preferred generic, specialty, etc.)"
    Value: CodeableConcept from DrugTierVS if covered // CodeableConcept from DrugTierVS if covered

    Element: DrugTierDescription
    Description: "A short title describing the drug tier"
    Value: string

    Element: MailOrder
    Description: "Boolean: does this tier include a mail order option"
    Value: boolean

    Element: CostSharing
      1..1 PharmacyType
      1..1 CopayAmount
      1..1 CopayOption
      1..1 CoInsuranceRate
      0..1 CoinsuranceOption
      
      Element: PharmacyType
      Description: "A code for the general payment network status."
      Value: CodeableConcept from PharmacyTypeVS if covered  // CodeableConcept from PharmacyTypeVS if covered 
    
      Element: CopayAmount
      Description: "A standard, nominal fee charged for each prescription of a drug"
      Value: decimal

      Element: CoInsuranceRate
      Description: "A fee charged for each prescription of a drug, expressed as a percentage of that drug's overall cost"
      Value: decimal
      
      Element: CopayOption
      Description: "Copay Description"
      Value: CodeableConcept from CopayOptionVS 
      
      Element: CoinsuranceOption
      Description: "CoinsuranceDescription"
      Value: CodeableConcept from CoinsuranceOptionVS 


EntryElement: FormularyDrug
Description: "Drug information which is part of a formulary."
1..1    DrugCode
1..1    DrugTierID
0..1    PriorAuthorization
0..1    StepTherapyLimit
0..1    QuantityLimit
0..*    DrugClass


EntryElement: FormularyDrugOption2
// Based on:	  Medication
Description:  "A drug that is included in a formulary. This profile is an alternate representation using the FHIR Medication resource."
1..1    DrugCode    // this is inherited from Medication ObjectiveFHIR Base Class
1..1    DrugTierID
0..1    PriorAuthorization
0..1    StepTherapyLimit
0..1    QuantityLimit
0..*    DrugClass

  Element: DrugCode
  Description: "RxNorm Code for a Formulary Drug from an appropriate type"
  Value: CodeableConcept from  http://hl7.org/fhir/us/core/ValueSet/us-core-medication-codes if covered

  Element: QuantityLimit
  Description: "Are there quanitity limitations?"
  Value: boolean

  Element: StepTherapyLimit
  Description: "Are there step therapy limitations?"
  Value: boolean

  Element: PriorAuthorization
  Description: "is prior authorization required?"
  Value: boolean
 
  Element:  DrugClass
  Description: "Classification of drug under available code."
  Value:   CodeableConcept

Element:	CoveragePlanMedicationKnowledge
// Based on:		List
// *** MLT20190519 - this will be deprecated after we verify testing CoveragePlan entry reference to both Medication and MedicationKnowledge.
Description:  "A health plan which contains a list of formulary drugs covered under that plan. This profile is identical to CoveragePlan but except that the reference is to the formulary drug based on the FHIR profile MedicationKnowledge instead of FormularyDrug based on the FHIR Medication resource."
1..1      PlanIDType
1..1      PlanID
0..1      MarketingURL
0..1      MarketingName
0..1      FormularyURL
1..1      CoveragePlanStatus
1..1      CoveragePlanMode
0..1      EmailPlanContact
1..*      Network
0..*      DrugTierDefinition
0..*      FormularyDrugEntry
0..1      LastUpdatedOn


Element:		Money1  // added given a the current design of the Money element which brings in Quantity attributes not referenced in FHIR R4 Money datatype.
Description:	"Representation of an amount of currency or monetary value."
0..1			MoneyAmount1
0..1			Currency1

			Element:	MoneyAmount1
			Description: "Numerical value (with implicit precision)"
			Value:		decimal

			Element:	Currency1
			Description: "ISO 4217 Currency Code"
			Value:      CodeableConcept from http://hl7.org/fhir/ValueSet/currencies